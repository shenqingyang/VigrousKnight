## 说明文档

#### 游戏介绍

本游戏主要实现了以下几点功能：

1.角色的基本移动，以及攻击（废话），鼠标控制任务朝向，若手中的武器是远程武器，则靠近敌人切换手刀

2.敌人的索敌，寻路以及攻击

3.不同的武器（近战，远程，远程还有不同的攻击模式）

4.按Q切换武器及靠近武器按空格捡拾

5.地图的随机生成（就是有bug）

6.清理完所有敌人后会生成奖励箱子，奖励箱子随机生成一个血瓶或蓝瓶，以及若干金币，血瓶蓝瓶靠近按空格捡拾

7.敌人受到的攻击的动画，玩家受到攻击的动画以及镜头抖动效果

8.多种敌人，包括近战，远程以及固定的和精英怪

9.实现探索式小地图，靠近房间在小地图上显示该地图的位置

10.实现游戏记录储存功能，从游戏中回到主界面可以记录玩家当时的血量，金币数，蓝量以及第几关，在开始菜单点击继续游戏即可传送回上一次游玩的关卡

11.多种地图模板随机生给每张地图（就是有bug😅）

12.奖励房间与特殊房间，可以破坏黄蓝水井获得大量金币与能量，奖励房间有武器箱子，可以随机获得一种武器

13.敌人与玩家受到伤害后会显示手上的数字

14.当玩家进入有敌人的房间时，会有空气墙阻止玩家走出房间、

15.主菜单动画（可有可无）

16.血量，蓝量，盾牌值，金币，技能条随数值的变化而变化

#### 程序实现

1. 玩家移动的实现是检测w,a,s,d键是否被按下，并给予该放下一速度；攻击写在了武器的脚本里，检测按下左键攻击；受到是检测玩家周边是否有Tag为enemy的物体进入，若有且手中武器的tag为gun，则禁用该武器，并激活手刀

2. 敌人的索敌是判断玩家与敌人的距离是否小于索敌的距离，如果小于，敌人的移动方向变为玩家的坐标，若果到达了攻击距离则攻击玩家，如果超出索敌范围则生成在房间中的随机坐标移动

3. 远程武器就是生成不同数量，速度的子弹，有些子弹我给他的刚体上加上了物理材质是他可以反弹，近战就是攻击时打开碰撞器，不攻击是关闭，把开关加载动画事件里实现；

4. 在人物的脚本里添加一个长度为2的数组，用来放置手中的武器，若按下Q键，若手中只有一把武器，则不切换，若手中有两把武器，则检测当前武器的编号并把当前武器禁用，把武器编号变为另一把武器的，开启另一把武器

5. 设置一个地图生成点，可以根据地图的大小一一地图为单位延x,y轴移动，制作地图的预制体，加入碰撞器，若地图生成点检测到当前位置有碰撞发生，则再次生成另一个点。

6. 给房间加脚本，在2到3的范围内随机生成波数，每生成一波敌人波数减一，当波数为0时bool为false，不在生成敌人，且生成宝箱预制体，宝箱随机生成12到20个物品，若生成了蓝瓶血瓶则从生成物中去掉他们；

7. 当敌人或玩家受到攻击时，获取碰撞物体的位置，向物体位置的反方向给予速度，并把受伤的bool变为true,在此期间内玩家不能移动，当过了受伤时间时，BOOL变为FALSE,玩家可以进行正常的移动与攻击；镜头抖动是提前给摄像机录制一段动画，当玩家受到伤害时打开trigger

8. 完成一个敌人Ai后修改一下直接复制给其他敌人，攻击方式更改为发射子弹或者近战

9. 创建第二个摄像机，把视野拉到合适的距离，位置在随机生成地图的时候记录地图x,y轴的最大值与最小值，加起来除以二，把摄像机的位置设置为改坐标。让摄像机只显示地图的图层。给地图加脚本，当人物靠近时生成地板。

10. 给人物数据设置为不可销毁，在游戏一开始单独设置一个场景用来生成数据，然后进入主菜单，在游戏过程中无法返回该场景；在该物体的脚本中记录对玩家的各种数据，议机关卡数，当点击新游戏是初始化；

11. 创造多种装饰物模板，给地图生成点加入装饰数组，在生成房间时随机给房间生成装饰物

12. 在生成地图是记录只有一条通路的地图和随机一个地图，把他们的生成敌人的bool变为false，在其中放入武器箱子和黄蓝水晶。

13.  创建一个文本ui的预制体，设置自动销毁时间，当受到伤害时在受伤物体位置生成Ui预制体

14. 给每一个门加脚本和碰撞体，当检测到玩家进入到房间时碰撞体开启，当检测到场景中没有tag为enemy的物体时，碰撞器关闭

15. 将按钮放到主菜单下面，当点击开始游戏时，让按钮以一定的速度移动到坐标。骑士的围巾随时间减少透明度并最终完全出现。

16. 创建图像Ui，设置其为横向或竖直填充，填充度，由当前数据与最大数据相除得出。

    

    #### 引用的插件包

    只用了unity初始的插件包，其他的一个没用，过!

    #### 代码架构

    分为地图，人物，UI，敌人，物品，近战武器，远程武器几个大类，武器类除了单独的脚本外还有共用的记录武器各种数值的脚本，便于人物以及敌人大类识别与调用。人物的生命值等数值设置为了静态变量以便UI大类调用。人物的脚本下有受到伤害与伤害动画的函数，在敌人攻击任务时调用，敌人的武器归于武器大类，在攻击人物时，人物的脚本读取武器的通用脚本并受到伤害。物品直接调用人物修改各种数值的函数，来实现捡拾物品后人物耕种数值的改变。

